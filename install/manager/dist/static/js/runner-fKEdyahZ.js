import{_ as I,J as u,q as s,M as S,o as l,c as m,j as p,w as v,b as _,m as t,A as a,v as c,N as V,t as f,F as q,i as x,aj as H,ak as N}from"./index-RjY-6op9.js";import j from"./resourceItem-umxsvmZh.js";import"./index-i5ApTNoK.js";const B={name:"resources",components:{resourceItem:j},data(){return{qType:[],listQuery:{page:1,page_size:10,subject:null,search:null},loading:!1,chiData:{},showAddQuestion:!1,total:0,listData:[],rid:null,captureName:null}},created(){this.getList(),this.getOptions()},methods:{getOptions(){u.get("/api/admin/ctf/question/type").then(e=>{this.qType=e.data})},getList(){this.loading=!0,u.get("/api/admin/vulnerability/runner",this.listQuery).then(e=>{this.listData=e.data,this.loading=!1,this.total=e.total}).catch(e=>{})},handleSizeChange(e){this.listQuery.page_size=e,this.getList()},handleCurrentChange(e){this.listQuery.page=e,this.getList()},buildHandle(e){u.post(`/api/admin/docker/resource/${e.id}/build`).then(d=>{this.$message.success("任务已提交"),this.getList()})},editHandle(e){this.$router.push({name:"vulnerability.edit_resource",query:{id:e.id}})},destroyHandle(e){u.post("/api/admin/vulnerability/runner/destroy",{id:e.id}).then(d=>{this.$message({message:"删除成功",type:"success"}),this.getList()})},handleAdd(e){this.showAddQuestion=!1,e&&this.getList()},switchActive(e,d){u.put(`/api/admin/ctf/question/${d.id}`,{active:e}).then(C=>{this.$message({message:"修改成功",type:"success",duration:2e3})})}}},T=e=>(H("data-v-c815b632"),e=e(),N(),e),F={class:"page-container"},O={class:"widget"},E=T(()=>_("div",{class:"tool-bar"},"资源",-1)),J={class:"search-group"},M={class:"widget-content"},U={key:1},G={class:"page-r"};function K(e,d,C,P,i,r){const k=s("resourceItem"),Q=s("el-input"),y=s("el-form-item"),h=s("el-button"),z=s("el-form"),w=s("el-tag"),o=s("el-table-column"),A=s("el-table"),D=s("el-pagination"),L=S("loading");return l(),m("div",F,[i.showAddQuestion?(l(),p(k,{key:0,data:i.chiData,show:i.showAddQuestion,onAction:r.handleAdd},null,8,["data","show","onAction"])):v("",!0),_("div",O,[E,_("div",J,[t(z,{inline:""},{default:a(()=>[t(y,null,{default:a(()=>[t(Q,{modelValue:i.listQuery.search,"onUpdate:modelValue":d[0]||(d[0]=n=>i.listQuery.search=n),placeholder:"题目名称"},null,8,["modelValue"])]),_:1}),t(y,null,{default:a(()=>[t(h,{type:"primary",onClick:r.getList},{default:a(()=>[c("查询")]),_:1},8,["onClick"])]),_:1})]),_:1})]),_("div",M,[V((l(),p(A,{fit:"","highlight-current-row":"",stripe:"",data:i.listData},{default:a(()=>[t(o,{align:"center",label:"用户",prop:"username",width:"180"},{default:a(n=>[n.row.admin_id?(l(),p(w,{key:0},{default:a(()=>[c(f(n.row.username),1)]),_:2},1024)):(l(),m("span",U,f(n.row.username),1))]),_:1}),t(o,{align:"center",label:"标题",prop:"resource.name",width:"220"}),t(o,{align:"center",label:"组件",prop:"resource.app",width:"180"}),t(o,{align:"center",label:"镜像",prop:"resource.image","show-overflow-tooltip":""}),t(o,{align:"center",label:"容器ID",prop:"container_id",width:"160"}),t(o,{align:"center",label:"端口信息",prop:"port_info",width:"200"},{default:a(n=>[(l(!0),m(q,null,x(n.row.port_info,(g,b)=>(l(),m("div",null,[(l(),p(w,{key:b},{default:a(()=>[c(f(b)+":"+f(g),1)]),_:2},1024))]))),256))]),_:1}),t(o,{align:"center",label:"启动时间",prop:"date_created",width:"200"}),t(o,{align:"center",label:"操作",width:"220"},{default:a(n=>[n.row.status===0?(l(),p(h,{key:0,type:"primary",onClick:g=>r.buildHandle(n.row),link:""},{default:a(()=>[c("编译 ")]),_:2},1032,["onClick"])):v("",!0),t(h,{type:"primary",onClick:g=>r.editHandle(n.row),link:""},{default:a(()=>[c("编辑")]),_:2},1032,["onClick"]),t(h,{type:"danger",onClick:g=>r.destroyHandle(n.row),link:""},{default:a(()=>[c("销毁")]),_:2},1032,["onClick"])]),_:1})]),_:1},8,["data"])),[[L,i.loading]]),_("div",G,[t(D,{"current-page":i.listQuery.page,"page-size":i.listQuery.page_size,"page-sizes":[10,20,30,50],total:i.total,background:"",layout:"total, sizes, prev, pager, next, jumper",onSizeChange:r.handleSizeChange,onCurrentChange:r.handleCurrentChange},null,8,["current-page","page-size","total","onSizeChange","onCurrentChange"])])])])])}const Y=I(B,[["render",K],["__scopeId","data-v-c815b632"]]);export{Y as default};
