import{_ as z,J as _,q as s,M as D,o as d,c as y,m as t,A as a,F as S,i as j,j as m,v as r,b as u,N as I,aj as L,ak as N}from"./index-RjY-6op9.js";import B from"./questionItem-5__Mn32o.js";const H={name:"Question",components:{questionItem:B},data(){return{qType:[],listQuery:{page:1,page_size:10,subject:null,search:null},loading:!1,chiData:{},showAddQuestion:!1,total:0,listData:[],rid:null,captureName:null}},created(){this.getList(),this.getOptions()},methods:{getOptions(){_.get("/api/admin/ctf/question/type").then(e=>{this.qType=e.data})},handleSyncRemoteCtfRepo(){_.post("/api/admin/ctf/sync_repo").then(e=>{this.$message({message:"任务提交成功",type:"success"})})},getList(){this.loading=!0,_.get("/api/admin/ctf/question",this.listQuery).then(e=>{this.listData=e.results,this.loading=!1,this.total=e.total}).catch(e=>{})},handleSizeChange(e){this.listQuery.page_size=e,this.getList()},handleCurrentChange(e){this.listQuery.page=e,this.getList()},handleCreate(){this.chiData={capture:this.rid},this.showAddQuestion=!0},editHandle(e){this.chiData=e,this.showAddQuestion=!0},deleteHandle(e){_.delete(`/api/admin/ctf/question/${e.id}`).then(c=>{this.$message({message:"删除成功",type:"success"}),this.getList()})},handleAdd(e){this.showAddQuestion=!1,e&&this.getList()},switchActive(e,c){_.post(`/api/admin/ctf/question/${c.id}/set_active`,{active:e}).then(w=>{this.$message({message:"修改成功",type:"success",duration:2e3})})}}},R=e=>(L("data-v-606c959e"),e=e(),N(),e),T={class:"main"},U={class:"w-[99/100] mt-2 px-2 pb-2 bg-bg_color"},F={class:"flex justify-between w-full h-[60px] p-4"},O=R(()=>u("p",{class:"font-bold truncate"},"题目列表",-1)),E={class:"flex items-center justify-around"},J={class:"page-r"};function M(e,c,w,G,n,o){const b=s("questionItem"),C=s("el-option"),v=s("el-select"),g=s("el-form-item"),k=s("el-input"),p=s("el-button"),Q=s("el-form"),i=s("el-table-column"),V=s("el-switch"),f=s("el-tag"),q=s("el-table"),A=s("el-pagination"),x=D("loading");return d(),y("div",T,[t(b,{data:n.chiData,show:n.showAddQuestion,onAction:o.handleAdd},null,8,["data","show","onAction"]),t(Q,{class:"search-form bg-bg_color w-[99/100] pl-8 pt-[12px]",inline:!0},{default:a(()=>[t(g,{class:"el-form-item",label:"分类"},{default:a(()=>[t(v,{modelValue:n.listQuery.subject,"onUpdate:modelValue":c[0]||(c[0]=l=>n.listQuery.subject=l),class:"select",clearable:""},{default:a(()=>[(d(!0),y(S,null,j(n.qType,l=>(d(),m(C,{key:l,label:l,value:l},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),t(g,null,{default:a(()=>[t(k,{modelValue:n.listQuery.search,"onUpdate:modelValue":c[1]||(c[1]=l=>n.listQuery.search=l),placeholder:"题目名称"},null,8,["modelValue"])]),_:1}),t(g,null,{default:a(()=>[t(p,{type:"primary",onClick:o.getList},{default:a(()=>[r("查询")]),_:1},8,["onClick"]),t(p,{type:"primary",onClick:o.handleSyncRemoteCtfRepo},{default:a(()=>[r("同步仓库资源")]),_:1},8,["onClick"])]),_:1})]),_:1}),u("div",U,[u("div",F,[O,u("div",E,[t(p,{type:"primary",onClick:o.handleCreate},{default:a(()=>[r("添加")]),_:1},8,["onClick"])])]),u("div",null,[I((d(),m(q,{fit:"","highlight-current-row":"",stripe:"",data:n.listData},{default:a(()=>[t(i,{align:"center",label:"ID",prop:"id",width:"80"}),t(i,{align:"center",label:"标题",prop:"name",width:"220"}),t(i,{align:"center",label:"类别",prop:"type",width:"180"}),t(i,{align:"center",label:"是否启用",prop:"name",width:"80"},{default:a(l=>[t(V,{modelValue:l.row.active,"onUpdate:modelValue":h=>l.row.active=h,onChange:h=>o.switchActive(h,l.row)},null,8,["modelValue","onUpdate:modelValue","onChange"])]),_:1}),t(i,{align:"center",label:"是否动态",width:"80"},{default:a(l=>[l.row.active_flag?(d(),m(f,{key:0,effect:"dark"},{default:a(()=>[r("是")]),_:1})):(d(),m(f,{key:1,effect:"dark",type:"warning"},{default:a(()=>[r("否")]),_:1}))]),_:1}),t(i,{align:"center",label:"积分",prop:"score",width:"80"}),t(i,{align:"center",label:"环境",prop:"resource_name",width:"180"}),t(i,{align:"center",label:"描述",prop:"desc","show-overflow-tooltip":""}),t(i,{align:"center",label:"操作",width:"160"},{default:a(l=>[t(p,{link:"",type:"primary",onClick:h=>o.editHandle(l.row)},{default:a(()=>[r("编辑")]),_:2},1032,["onClick"]),t(p,{link:"",type:"danger",onClick:h=>o.deleteHandle(l.row)},{default:a(()=>[r("删除")]),_:2},1032,["onClick"])]),_:1})]),_:1},8,["data"])),[[x,n.loading]]),u("div",J,[t(A,{"current-page":n.listQuery.page,"page-size":n.listQuery.page_size,"page-sizes":[10,20,30,50],total:n.total,background:"",layout:"total, sizes, prev, pager, next, jumper",onSizeChange:o.handleSizeChange,onCurrentChange:o.handleCurrentChange},null,8,["current-page","page-size","total","onSizeChange","onCurrentChange"])])])])])}const W=z(H,[["render",M],["__scopeId","data-v-606c959e"]]);export{W as default};
