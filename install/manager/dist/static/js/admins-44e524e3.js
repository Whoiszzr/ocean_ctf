import{_ as L,az as c,aI as w,q as n,J as D,o as p,c as f,b as d,m as l,A as i,v as r,K as Q,j as y,t as h,F as S,i as U,ai as I,aj as B}from"./index-5ba26d12.js";import j from"./editAdmin-eb84140b.js";const q={name:"Account",components:{EditAdmin:j},filters:{statusFilter(t){return{published:"success",draft:"info",deleted:"danger"}[t]}},data(){return{isEdit:!1,editForm:{},TeamOptions:[],list:null,total:0,listLoading:!0,listQuery:{search:null,page:1,page_size:10},roles:[],RolesData:[],formData:{email:null,id:null,username:null,confirm_password:null,password:null}}},created(){this.getList()},methods:{getList(){this.listLoading=!0,c.get("/api/admin/admin",this.listQuery).then(t=>{this.list=t.data,this.total=t.total,this.listLoading=!1})},getRole(){c.get("/api/admin/role").then(t=>{this.roles=t.data})},handleDelete(t){c.delete(`/api/admin/admin/${t.id}`).then(a=>{w.success("删除成功"),this.getList()})},handleSizeChange(t){this.listQuery.page_size=t,this.getList()},handleCurrentChange(t){this.listQuery.page=t,this.getList()},handleFilter(){this.getList()},handleCreate(t){this.getRole(),this.isEdit=!0,this.editForm={}},handleEdit(t){this.isEdit=!1,t&&this.getList()},handleUpdate(t){this.formData=t,this.isEdit=!0},submit(){this.editForm.id?c.put(`/api/admin/admin/${this.editForm.id}`,this.editForm).then(t=>{this.$message({message:"操作成功",type:"success"}),this.getList()}).catch(t=>{}).finally(()=>{this.isEdit=!1}):c.post("/api/admin/admin",this.editForm).then(t=>{w.success("添加成功"),this.getList()}).catch(t=>{}).finally(()=>{this.isEdit=!1})}}},A=t=>(I("data-v-d548b76e"),t=t(),B(),t),M={class:"page-container"},N={class:"widget"},R=A(()=>d("div",{class:"tool-bar"},"管理员列表",-1)),T={class:"search-group"},J={class:"widget-body"},K={key:1},O={class:"page-r"};function G(t,a,H,P,s,o){const g=n("el-input"),u=n("el-form-item"),m=n("el-button"),b=n("el-form"),_=n("el-table-column"),C=n("el-tag"),v=n("el-table"),F=n("el-pagination"),V=n("el-option"),k=n("el-select"),x=n("el-dialog"),z=D("loading");return p(),f("div",M,[d("div",N,[R,d("div",T,[l(b,{inline:""},{default:i(()=>[l(u,null,{default:i(()=>[l(g,{modelValue:s.listQuery.search,"onUpdate:modelValue":a[0]||(a[0]=e=>s.listQuery.search=e),style:{width:"200px"},placeholder:"用户名/邮箱"},null,8,["modelValue"])]),_:1}),l(u,null,{default:i(()=>[l(m,{type:"primary",onClick:o.handleFilter},{default:i(()=>[r("查询")]),_:1},8,["onClick"]),l(m,{type:"primary",onClick:a[1]||(a[1]=e=>o.handleCreate({}))},{default:i(()=>[r("添加")]),_:1})]),_:1})]),_:1})]),d("div",J,[Q((p(),y(v,{data:s.list,"highlight-current-row":""},{default:i(()=>[l(_,{align:"center",type:"index",width:"80",label:"序号",fixed:"left"}),l(_,{label:"用户名",width:"150px",align:"center"},{default:i(e=>[e.row.is_captain?(p(),y(C,{key:0,effect:"dark"},{default:i(()=>[r(h(e.row.username),1)]),_:2},1024)):(p(),f("span",K,h(e.row.username),1))]),_:1}),l(_,{align:"center",label:"角色"},{default:i(e=>[d("span",null,h(e.row.role_name),1)]),_:1}),l(_,{label:"上次登陆时间",width:"160",align:"center"},{default:i(e=>[d("span",null,h(e.row.login_time),1)]),_:1}),l(_,{align:"center",label:"操作",width:"200"},{default:i(e=>[l(m,{type:"primary",onClick:E=>o.handleCreate(e.row),link:""},{default:i(()=>[r("编辑")]),_:2},1032,["onClick"]),l(m,{type:"danger",onClick:E=>o.handleDelete(e.row),link:""},{default:i(()=>[r("删除")]),_:2},1032,["onClick"])]),_:1})]),_:1},8,["data"])),[[z,s.listLoading]]),d("div",O,[l(F,{background:"","current-page":s.listQuery.page,"page-sizes":[5,10,30],"page-size":s.listQuery.page_size,layout:"total, sizes, prev, pager, next, jumper",total:s.total,onSizeChange:o.handleSizeChange,onCurrentChange:o.handleCurrentChange},null,8,["current-page","page-size","total","onSizeChange","onCurrentChange"])])]),l(x,{center:"",modelValue:s.isEdit,"onUpdate:modelValue":a[7]||(a[7]=e=>s.isEdit=e),title:s.editForm.id?"编辑":"新增管理员",onClose:a[8]||(a[8]=e=>t.$emit("handleEdit",!1)),width:"700"},{footer:i(()=>[l(m,{onClick:a[6]||(a[6]=e=>o.handleEdit(!1))},{default:i(()=>[r("取消")]),_:1}),l(m,{type:"primary",onClick:o.submit},{default:i(()=>[r(h(s.formData.id?"更新":"提交"),1)]),_:1},8,["onClick"])]),default:i(()=>[l(b,{ref:"dataForm",model:s.editForm,"label-position":"left","label-width":"80px","label-suffix":":",style:{width:"500px",margin:"auto auto","font-size":"13px"}},{default:i(()=>[l(u,{label:"用户名",prop:"username",required:""},{default:i(()=>[l(g,{modelValue:s.editForm.username,"onUpdate:modelValue":a[2]||(a[2]=e=>s.editForm.username=e)},null,8,["modelValue"])]),_:1}),l(u,{class:"el-form-item",label:"角色",required:""},{default:i(()=>[l(k,{modelValue:s.editForm.role,"onUpdate:modelValue":a[3]||(a[3]=e=>s.editForm.role=e),class:"select",clearable:""},{default:i(()=>[(p(!0),f(S,null,U(s.roles,e=>(p(),y(V,{key:e.id,label:e.name,value:e.id},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),l(u,{label:"密    码",prop:"password"},{default:i(()=>[l(g,{modelValue:s.editForm.password,"onUpdate:modelValue":a[4]||(a[4]=e=>s.editForm.password=e),type:"password"},null,8,["modelValue"])]),_:1}),l(u,{label:"确认密码",prop:"confirm_password",style:{"font-size":"12px"}},{default:i(()=>[l(g,{modelValue:s.editForm.confirm_password,"onUpdate:modelValue":a[5]||(a[5]=e=>s.editForm.confirm_password=e),type:"password"},null,8,["modelValue"])]),_:1})]),_:1},8,["model"])]),_:1},8,["modelValue","title"])])])}const Y=L(q,[["render",G],["__scopeId","data-v-d548b76e"]]);export{Y as default};
