import{_ as I,az as u,q as s,J as S,o as l,c as m,j as _,w as C,b as p,m as t,A as n,v as c,K as x,t as f,F as V,i as q,ai as H,aj as N}from"./index-5ba26d12.js";import j from"./resourceItem-ea7b9ee8.js";import"./index-c8cd2670.js";const B={name:"resources",components:{resourceItem:j},data(){return{qType:[],listQuery:{page:1,page_size:10,subject:null,search:null},loading:!1,chiData:{},showAddQuestion:!1,total:0,listData:[],rid:null,captureName:null}},created(){this.getList(),this.getOptions()},methods:{getOptions(){u.get("/api/admin/ctf/question/type").then(e=>{this.qType=e.data})},getList(){this.loading=!0,u.get("/api/admin/vuln/runner",this.listQuery).then(e=>{this.listData=e.data,this.loading=!1,this.total=e.total}).catch(e=>{})},handleSizeChange(e){this.listQuery.page_size=e,this.getList()},handleCurrentChange(e){this.listQuery.page=e,this.getList()},buildHandle(e){u.post(`/api/admin/docker/resource/${e.id}/build`).then(d=>{this.$message.success("任务已提交"),this.getList()})},editHandle(e){this.$router.push({name:"vuln.edit_resource",query:{id:e.id}})},deleteHandle(e){u.delete(`/api/admin/vuln/runner/${e.id}`).then(d=>{this.$message({message:"删除成功",type:"success"}),this.getList()})},handleAdd(e){this.showAddQuestion=!1,e&&this.getList()},switchActive(e,d){u.put(`/api/admin/ctf/question/${d.id}`,{active:e}).then(b=>{this.$message({message:"修改成功",type:"success",duration:2e3})})}}},T=e=>(H("data-v-6001dd9e"),e=e(),N(),e),F={class:"page-container"},O={class:"widget"},E=T(()=>p("div",{class:"tool-bar"},"资源",-1)),J={class:"search-group"},K={class:"widget-content"},U={key:1},G={class:"page-r"};function M(e,d,b,P,i,r){const k=s("resourceItem"),z=s("el-input"),w=s("el-form-item"),h=s("el-button"),Q=s("el-form"),y=s("el-tag"),o=s("el-table-column"),A=s("el-table"),D=s("el-pagination"),L=S("loading");return l(),m("div",F,[i.showAddQuestion?(l(),_(k,{key:0,data:i.chiData,show:i.showAddQuestion,onAction:r.handleAdd},null,8,["data","show","onAction"])):C("",!0),p("div",O,[E,p("div",J,[t(Q,{inline:""},{default:n(()=>[t(w,null,{default:n(()=>[t(z,{modelValue:i.listQuery.search,"onUpdate:modelValue":d[0]||(d[0]=a=>i.listQuery.search=a),placeholder:"题目名称"},null,8,["modelValue"])]),_:1}),t(w,null,{default:n(()=>[t(h,{type:"primary",onClick:r.getList},{default:n(()=>[c("查询")]),_:1},8,["onClick"])]),_:1})]),_:1})]),p("div",K,[x((l(),_(A,{fit:"","highlight-current-row":"",stripe:"",data:i.listData},{default:n(()=>[t(o,{align:"center",label:"用户",prop:"username",width:"180"},{default:n(a=>[a.row.admin_id?(l(),_(y,{key:0},{default:n(()=>[c(f(a.row.username),1)]),_:2},1024)):(l(),m("span",U,f(a.row.username),1))]),_:1}),t(o,{align:"center",label:"标题",prop:"resource.name",width:"220"}),t(o,{align:"center",label:"组件",prop:"resource.app",width:"180"}),t(o,{align:"center",label:"镜像",prop:"resource.image","show-overflow-tooltip":""}),t(o,{align:"center",label:"容器ID",prop:"container_id",width:"160"}),t(o,{align:"center",label:"端口信息",prop:"port_info",width:"200"},{default:n(a=>[(l(!0),m(V,null,q(a.row.port_info,(g,v)=>(l(),m("div",null,[(l(),_(y,{key:v},{default:n(()=>[c(f(v)+":"+f(g),1)]),_:2},1024))]))),256))]),_:1}),t(o,{align:"center",label:"启动时间",prop:"date_created",width:"200"}),t(o,{align:"center",label:"操作",width:"220"},{default:n(a=>[a.row.status===0?(l(),_(h,{key:0,type:"primary",onClick:g=>r.buildHandle(a.row),link:""},{default:n(()=>[c("编译 ")]),_:2},1032,["onClick"])):C("",!0),t(h,{type:"primary",onClick:g=>r.editHandle(a.row),link:""},{default:n(()=>[c("编辑")]),_:2},1032,["onClick"]),t(h,{type:"danger",onClick:g=>r.deleteHandle(a.row),link:""},{default:n(()=>[c("销毁")]),_:2},1032,["onClick"])]),_:1})]),_:1},8,["data"])),[[L,i.loading]]),p("div",G,[t(D,{"current-page":i.listQuery.page,"page-size":i.listQuery.page_size,"page-sizes":[10,20,30,50],total:i.total,background:"",layout:"total, sizes, prev, pager, next, jumper",onSizeChange:r.handleSizeChange,onCurrentChange:r.handleCurrentChange},null,8,["current-page","page-size","total","onSizeChange","onCurrentChange"])])])])])}const Y=I(B,[["render",M],["__scopeId","data-v-6001dd9e"]]);export{Y as default};
