import{_ as z,J as h,q as s,M as D,o as r,c as w,m as t,A as a,F as j,i as I,j as g,v as d,b as u,N as L,aj as S,ak as N}from"./index-QDrcbRr8.js";import B from"./questionItem-5jK22RUU.js";const H={name:"Question",components:{questionItem:B},data(){return{qType:[],listQuery:{page:1,page_size:10,subject:null,search:null},loading:!1,chiData:{},showAddQuestion:!1,total:0,listData:[],rid:null,captureName:null}},created(){this.getList(),this.getOptions()},methods:{getOptions(){h.get("/api/admin/ctf/question/type").then(e=>{this.qType=e.data})},handleSyncRemoteCtfRepo(){h.post("/api/admin/ctf/sync_repo").then(e=>{this.$message({message:"任务提交成功",type:"success"})})},getList(){this.loading=!0,h.get("/api/admin/ctf/question",this.listQuery).then(e=>{this.listData=e.results,this.loading=!1,this.total=e.total}).catch(e=>{})},handleSizeChange(e){this.listQuery.page_size=e,this.getList()},handleCurrentChange(e){this.listQuery.page=e,this.getList()},handleCreate(){this.chiData={capture:this.rid},this.showAddQuestion=!0},editHandle(e){this.chiData=e,this.showAddQuestion=!0},deleteHandle(e){h.delete(`/api/admin/ctf/question/${e.id}`).then(c=>{this.$message({message:"删除成功",type:"success"}),this.getList()})},handleAdd(e){this.showAddQuestion=!1,e&&this.getList()},switchActive(e,c){h.post(`/api/admin/ctf/question/${c.id}/set_active`,{active:e}).then(b=>{this.$message({message:"修改成功",type:"success",duration:2e3})})}}},T=e=>(S("data-v-5d64c5ab"),e=e(),N(),e),U={class:"main"},F={class:"w-[99/100] mt-2 px-2 pb-2 bg-bg_color"},O={class:"flex justify-between w-full h-[60px] p-4"},R=T(()=>u("p",{class:"font-bold truncate"},"题目列表",-1)),E={class:"flex items-center justify-around"},J={class:"page-r"};function M(e,c,b,G,n,i){const y=s("questionItem"),v=s("el-option"),C=s("el-select"),m=s("el-form-item"),k=s("el-input"),_=s("el-button"),Q=s("el-form"),o=s("el-table-column"),V=s("el-switch"),f=s("el-tag"),q=s("el-table"),A=s("el-pagination"),x=D("loading");return r(),w("div",U,[t(y,{data:n.chiData,show:n.showAddQuestion,onAction:i.handleAdd},null,8,["data","show","onAction"]),t(Q,{class:"search-form bg-bg_color w-[99/100] pl-8 pt-[12px]",inline:!0},{default:a(()=>[t(m,{class:"el-form-item",label:"分类"},{default:a(()=>[t(C,{modelValue:n.listQuery.subject,"onUpdate:modelValue":c[0]||(c[0]=l=>n.listQuery.subject=l),class:"select",clearable:"",filterable:"",placeholder:"请选择分类"},{default:a(()=>[(r(!0),w(j,null,I(n.qType,l=>(r(),g(v,{key:l,label:l,value:l},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),t(m,null,{default:a(()=>[t(k,{modelValue:n.listQuery.search,"onUpdate:modelValue":c[1]||(c[1]=l=>n.listQuery.search=l),placeholder:"题目名称"},null,8,["modelValue"])]),_:1}),t(m,null,{default:a(()=>[t(_,{type:"primary",onClick:i.getList},{default:a(()=>[d("查询")]),_:1},8,["onClick"])]),_:1})]),_:1}),u("div",F,[u("div",O,[R,u("div",E,[t(_,{type:"primary",onClick:i.handleCreate},{default:a(()=>[d("添加")]),_:1},8,["onClick"])])]),u("div",null,[L((r(),g(q,{fit:"","highlight-current-row":"",stripe:"",data:n.listData},{default:a(()=>[t(o,{align:"center",label:"ID",prop:"id",width:"80"}),t(o,{align:"center",label:"标题",prop:"name",width:"220"}),t(o,{align:"center",label:"类别",prop:"type",width:"180"}),t(o,{align:"center",label:"是否启用",prop:"name",width:"80"},{default:a(l=>[t(V,{modelValue:l.row.active,"onUpdate:modelValue":p=>l.row.active=p,onChange:p=>i.switchActive(p,l.row)},null,8,["modelValue","onUpdate:modelValue","onChange"])]),_:1}),t(o,{align:"center",label:"是否动态",width:"80"},{default:a(l=>[l.row.active_flag?(r(),g(f,{key:0,effect:"dark"},{default:a(()=>[d("是")]),_:1})):(r(),g(f,{key:1,effect:"dark",type:"warning"},{default:a(()=>[d("否")]),_:1}))]),_:1}),t(o,{align:"center",label:"积分",prop:"score",width:"80"}),t(o,{align:"center",label:"环境",prop:"resource_name",width:"180"}),t(o,{align:"center",label:"描述",prop:"desc","show-overflow-tooltip":""}),t(o,{align:"center",label:"操作",width:"160"},{default:a(l=>[t(_,{link:"",type:"primary",onClick:p=>i.editHandle(l.row)},{default:a(()=>[d("编辑")]),_:2},1032,["onClick"]),t(_,{link:"",type:"danger",onClick:p=>i.deleteHandle(l.row)},{default:a(()=>[d("删除")]),_:2},1032,["onClick"])]),_:1})]),_:1},8,["data"])),[[x,n.loading]]),u("div",J,[t(A,{"current-page":n.listQuery.page,"page-size":n.listQuery.page_size,"page-sizes":[10,20,30,50],total:n.total,background:"",layout:"total, sizes, prev, pager, next, jumper",onSizeChange:i.handleSizeChange,onCurrentChange:i.handleCurrentChange},null,8,["current-page","page-size","total","onSizeChange","onCurrentChange"])])])])])}const W=z(H,[["render",M],["__scopeId","data-v-5d64c5ab"]]);export{W as default};
