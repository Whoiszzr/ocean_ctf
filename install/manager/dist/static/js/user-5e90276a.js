import{_ as x,az as g,q as i,J as z,o as h,c as b,m as t,A as s,v as u,b as o,K as L,j as w,t as m,ai as S,aj as D}from"./index-5ba26d12.js";import U from"./addUser-f2f288c2.js";import{u as Q}from"./hooks-8c1fc708.js";import{d as j}from"./search-cc37b371.js";const B={name:"Account",components:{addUser:U},data(){return{loading:!1,dialogUser:!0,TeamOptions:[],list:null,total:0,listLoading:!0,listQuery:{search:null,page:1,page_size:10},RolesData:[],currentItemVisible:!1,currentItem:{}}},created(){this.getList()},methods:{Search(){return j},useRenderIcon:Q,getList(){this.listLoading=!0,g.get("/api/admin/user",this.listQuery).then(e=>{this.list=e.data,this.total=e.total,this.listLoading=!1})},userDelete(e){g.delete(`/api/admin/user/${e.id}`).then(a=>{this.$message({message:"删除成功",type:"success"}),this.getList()})},handleSizeChange(e){this.listQuery.page_size=e,this.getList()},handleCurrentChange(e){this.listQuery.page=e,this.getList()},handleCreate(){this.currentItem={},this.currentItemVisible=!0},handleUpdate(e){this.currentItem=e,this.currentItemVisible=!0},updateData(){if(this.currentItem.id){let e=this.currentItem;g.put(`/api/admin/user/${e.id}`,e).then(a=>{this.getList()}).catch(a=>{}).finally(()=>{this.currentItemVisible=!1})}else{let e=this.currentItem;if(!e.username){this.$message({message:"请输入用户名",type:"error"});return}if(!e.password){this.$message({message:"请输入密码",type:"error"});return}if(!e.confirm_password){this.$message({message:"请输入确认密码",type:"error"});return}if(e.password!==e.confirm_password){this.$message({message:"两次输入密码不一致",type:"error"});return}g.post("/api/admin/user",e).then(a=>{this.getList()}).catch(a=>{}).finally(()=>{this.currentItemVisible=!1})}}}},q=e=>(S("data-v-b1e0c66b"),e=e(),D(),e),N={class:"main"},R={class:"w-[99/100] mt-2 px-2 pb-2 bg-bg_color"},A={class:"flex justify-between w-full h-[60px] p-4"},T=q(()=>o("p",{class:"font-bold truncate"},"用户列表",-1)),E={class:"flex items-center justify-around"},F={key:1},J={class:"pagination-container"};function K(e,a,O,G,r,n){const _=i("el-input"),p=i("el-form-item"),d=i("el-button"),f=i("el-form"),c=i("el-table-column"),y=i("el-tag"),I=i("el-table"),C=i("el-pagination"),V=i("el-dialog"),k=z("loading");return h(),b("div",N,[t(f,{class:"search-form bg-bg_color w-[99/100] pl-8 pt-[12px]",inline:!0},{default:s(()=>[t(p,{label:"角色名称：",prop:"name"},{default:s(()=>[t(_,{modelValue:r.listQuery.search,"onUpdate:modelValue":a[0]||(a[0]=l=>r.listQuery.search=l),placeholder:"请输入用户名称",clearable:"",class:"!w-[200px]"},null,8,["modelValue"])]),_:1}),t(p,null,{default:s(()=>[t(d,{type:"primary",icon:n.useRenderIcon(n.Search()),loading:r.loading,onClick:n.getList},{default:s(()=>[u(" 搜索 ")]),_:1},8,["icon","loading","onClick"])]),_:1})]),_:1}),o("div",R,[o("div",A,[T,o("div",E,[t(d,{type:"primary",onClick:n.handleCreate},{default:s(()=>[u("添加")]),_:1},8,["onClick"])])]),o("div",null,[L((h(),w(I,{fit:"","highlight-current-row":"",stripe:"",data:r.list,style:{width:"100%"}},{default:s(()=>[t(c,{align:"center",label:"ID",width:"70px",prop:"id"}),t(c,{label:"用户名",width:"150px",align:"center"},{default:s(l=>[l.row.is_captain?(h(),w(y,{key:0,effect:"dark"},{default:s(()=>[u(m(l.row.username),1)]),_:2},1024)):(h(),b("span",F,m(l.row.username),1))]),_:1}),t(c,{width:"180px",align:"center",label:"邮箱"},{default:s(l=>[o("span",null,m(l.row.email),1)]),_:1}),t(c,{align:"center",label:"注册日期"},{default:s(l=>[o("span",null,m(l.row.date_created),1)]),_:1}),t(c,{align:"center",label:"上次登陆",width:"250"},{default:s(l=>[o("span",null,m(l.row.date_modified),1)]),_:1}),t(c,{align:"center",label:"操作",width:"200"},{default:s(l=>[t(d,{type:"primary",link:"",onClick:v=>n.handleUpdate(l.row)},{default:s(()=>[u("编辑")]),_:2},1032,["onClick"]),t(d,{type:"danger",link:"",onClick:v=>n.userDelete(l.row)},{default:s(()=>[u("删除")]),_:2},1032,["onClick"])]),_:1})]),_:1},8,["data"])),[[k,r.listLoading]]),o("div",J,[t(C,{background:"",class:"page-r","current-page":r.listQuery.page,"page-sizes":[10,20,30,50],"page-size":r.listQuery.page_size,layout:"total, sizes, prev, pager, next, jumper",total:r.total,onSizeChange:n.handleSizeChange,onCurrentChange:n.handleCurrentChange},null,8,["current-page","page-size","total","onSizeChange","onCurrentChange"])])])]),t(V,{title:r.currentItem.id?"编辑用户":"添加用户",modelValue:r.currentItemVisible,"onUpdate:modelValue":a[5]||(a[5]=l=>r.currentItemVisible=l),size:"mini","close-on-click-modal":!1,center:"",width:"600px"},{footer:s(()=>[t(d,{onClick:a[4]||(a[4]=l=>this.currentItemVisible=!1)},{default:s(()=>[u("取消")]),_:1}),t(d,{type:"primary",onClick:n.updateData},{default:s(()=>[u("提交")]),_:1},8,["onClick"])]),default:s(()=>[t(f,{ref:"dataForm",model:r.currentItem,"label-width":"100px","label-position":"right"},{default:s(()=>[t(p,{label:"用户名",prop:"username"},{default:s(()=>[t(_,{modelValue:r.currentItem.username,"onUpdate:modelValue":a[1]||(a[1]=l=>r.currentItem.username=l)},null,8,["modelValue"])]),_:1}),t(p,{label:"密    码",prop:"password",required:""},{default:s(()=>[t(_,{type:"password",modelValue:r.currentItem.password,"onUpdate:modelValue":a[2]||(a[2]=l=>r.currentItem.password=l),"show-password":""},null,8,["modelValue"])]),_:1}),t(p,{label:"确认密码",prop:"confirm_password",required:""},{default:s(()=>[t(_,{type:"password",modelValue:r.currentItem.confirm_password,"onUpdate:modelValue":a[3]||(a[3]=l=>r.currentItem.confirm_password=l),"show-password":""},null,8,["modelValue"])]),_:1})]),_:1},8,["model"])]),_:1},8,["title","modelValue"])])}const X=x(B,[["render",K],["__scopeId","data-v-b1e0c66b"]]);export{X as default};
